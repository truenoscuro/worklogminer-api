@Library("custom-library") _

def remote = [:]
remote.name = "vagrant"
remote.host = "172.17.177.22"
remote.allowAnyHosts = true

node {
    withCredentials([sshUserPrivateKey(
        credentialsId: 'server-docker', 
        keyFileVariable: 'identity',
        passphraseVariable: '', 
        usernameVariable: 'userName')]) {
            
            sh "cat $identity"
            remote.user =  userName
            remote.identityFile = identity

            sshCommand remote: remote , command: 'echo "hello world"'
    
    }
}
